*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
:root{
  --bg:linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
  --card:linear-gradient(145deg, #2a2a2a 0%, #353535 100%);
  --text:#ffffff;
  --text-secondary:#cccccc;
  --text-muted:#999999;
  --header:#1a1a1a;
  --header-gradient:linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
  --nav-gradient:linear-gradient(180deg, #1a1a1a 0%, #2a2a2a 100%);
  --border:rgba(192,192,192,0.4);
  --border-hover:rgba(192,192,192,0.7);
  --success:#4ecca3;
  --danger:#fca5a5;
  --warning:#e5e4e2;
  --expense:#fca5a5;
  --income:#6ee7b7;
  --gold:#e5e4e2;
  --gold-dim:rgba(229,228,226,0.3);
  --amber:#a1a1aa;
  --amber-glow:rgba(161,161,170,0.4);
  --platinum:#e5e4e2;
  --platinum-light:#d4d4d4;
  --zinc:#71717a;
  --zinc-light:#a1a1aa;
  --silver:#c0c0c0;
}

/* TEMA DARK - PLATINO LUXURY */
body.dark{
  --bg:linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
  --card:linear-gradient(145deg, #2a2a2a 0%, #353535 100%);
  --text:#ffffff;
  --text-secondary:#cccccc;
  --text-muted:#999999;
  --header:#1a1a1a;
  --header-gradient:linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
  --nav-gradient:linear-gradient(180deg, #1a1a1a 0%, #2a2a2a 100%);
  --border:rgba(192,192,192,0.4);
  --border-hover:rgba(192,192,192,0.7);
  background:#1a1a1a;
}




















/* Light Mode - Contrasto testi migliorato */
body{
  font-family:'Red Hat Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background:var(--bg);
  color:var(--text);
  padding-bottom:calc(75px + env(safe-area-inset-bottom));
  -webkit-font-smoothing:antialiased;
  overflow-x:hidden;
  min-height:100vh;
  touch-action:pan-y;
  transition:background 0.3s ease, color 0.3s ease;
}

/* CENTRA TUTTI I TESTI IMPORTANTI */
h1, h2, h3, h4 {
  text-align:center;
}
.amount, .trans-amount, .balance, .total {
  text-align:center;
}
.card-title, .section-title, .patrimonio-label {
  text-align:center;
}
p {
  text-align:center;
}
.stats .label, .stats .value {
  text-align:center;
}
.summary-item {
  text-align:center;
}

.header{
  background:var(--header-gradient);
  color:#fff;
  padding:max(env(safe-area-inset-top),20px) 15px 15px 15px;
  position:sticky;
  top:0;
  z-index:100;
  box-shadow:0 4px 20px rgba(0,0,0,0.4);
  border-bottom:3px solid var(--border);
  transition:background 0.3s ease;
}
.header h1{
  font-size:1.4em;
  margin-bottom:12px;
  font-weight:800;
  color:#e5e4e2;
  text-shadow:0 0 40px rgba(255,170,0,0.6);
  text-align:center;
  letter-spacing:-0.5px;
}
@media (max-width:480px){
  .header h1{
    font-size:1.7em;
  }
}
@media (max-width:390px){
  .header h1{
    font-size:1.55em;
  }
}
@media (max-width:360px){
  .header h1{
    font-size:1.45em;
  }
}
.hdr-row{
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  margin-bottom:12px;
  gap:8px;
}
.hdr-row h1{
  justify-self:center;
  grid-column:2;
  white-space:nowrap;
  display:flex;
  margin-left:0;
  margin-right:0;
  align-items:center;
  gap:8px;
}
.controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:center}
.period-selector{
  background:rgba(229,228,226,0.15);
  border:2px solid rgba(192,192,192,0.4);
  color:#e5e4e2;
  padding:10px 16px;
  border-radius:12px;
  font-size:1em;
  cursor:pointer;
  font-weight:700;
  white-space:nowrap;
  transition:all 0.3s ease;
  letter-spacing:0.5px;
  text-shadow:0 0 10px rgba(192,192,192,0.3);
}
.period-selector:hover{
  background:rgba(255,170,0,0.25);
  transform:translateY(-2px);
  border-color:rgba(255,170,0,0.7);
  box-shadow:0 4px 20px rgba(192,192,192,0.3);
}
.month-btn{
  background:rgba(42,42,42,0.8);
  border:2px solid rgba(192,192,192,0.3);
  color:#ffffff;
  padding:12px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  font-size:0.9em;
  transition:all 0.3s ease;
}
.month-btn:hover{
  background:rgba(255,170,0,0.2);
  color:#e5e4e2;
  border-color:rgba(255,170,0,0.6);
  transform:scale(1.05);
  box-shadow:0 4px 16px rgba(255,170,0,0.25);
}
.month-btn.selected{
  background:rgba(192,192,192,0.3);
  color:#e5e4e2;
  border-color:#e5e4e2;
  box-shadow:0 4px 16px rgba(192,192,192,0.4);
  font-weight:800;
  text-shadow:0 0 10px rgba(192,192,192,0.3);
}
.controls select{
  padding:12px;
  border-radius:10px;
  flex:0 1 auto;
  max-width:150px;
  font-size:1em;
  background:var(--card);
  color:var(--text);
  border:2px solid var(--border);
  font-weight:600;
  -webkit-appearance:none;
  appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;
  background-position:right 10px center;
  padding-right:35px;
}
.container{
  padding-left:max(env(safe-area-inset-left),15px);
  padding-right:max(env(safe-area-inset-right),15px);
  padding-top:15px;
  padding-bottom:calc(80px + max(env(safe-area-inset-bottom),20px));
  overflow-x:hidden;
  min-height:100vh;
}
.card{
  background:linear-gradient(145deg, #2a2a2a 0%, #353535 100%);
  border:2px solid rgba(192,192,192,0.4);
  border-radius:20px;
  padding:20px;
  margin-bottom:15px;
  box-shadow:0 10px 40px rgba(0,0,0,0.8),
              0 0 0 1px rgba(229,228,226,0.15) inset,
              0 4px 20px rgba(255,170,0,0.1);
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position:relative;
}
.card::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:3px;
  background:linear-gradient(90deg, transparent, #e5e4e2, transparent);
  opacity:0;
  transition:opacity 0.3s;
  border-radius:20px 20px 0 0;
}
.card:hover::before{
  opacity:1;
}
.card:hover{
  border-color:rgba(255,170,0,0.7);
  box-shadow:0 16px 60px rgba(255,170,0,0.25),
              0 0 0 1px rgba(192,192,192,0.3) inset;
  transform:translateY(-4px);
}
@media(max-width:600px){
  .card{
    padding:15px;
  }
}
.patrimonio{
  background:linear-gradient(145deg, #2a2a2a 0%, #353535 100%);
  border:3px solid rgba(255,170,0,0.5);
  color:#fff;
  text-align:center;
  padding:30px 20px;
  box-shadow:0 10px 40px rgba(255,170,0,0.2);
}
.big{
  font-size:2.8em;
  font-weight:800;
  margin:12px 0;
  letter-spacing:-1px;
  color:#ffffff;
  text-shadow:0 2px 12px rgba(255,255,255,0.15);
  text-align:center;
}
.patrimonio-label{
  font-size:0.95em;
  opacity:0.9;
  font-weight:500;
  text-align:center;
}
.metrics{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:15px}
.metric{
  background:var(--card);
  border-radius:14px;
  padding:18px;
  text-align:center;
  box-shadow:0 2px 8px rgba(0,0,0,0.06);
}
.metric h4{font-size:0.8em;margin-bottom:10px;opacity:0.7;font-weight:600}
.metric .val{font-size:1.6em;font-weight:700}
.metric-full{grid-column:1 / -1}
.top-expense{
  background:var(--card);
  border-radius:12px;
  padding:14px;
  margin-bottom:12px;
  border-left:5px solid var(--expense);
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 2px 6px rgba(0,0,0,0.05);
}
.top-expense .info{flex:1;padding-right:10px}
.top-expense .name{font-weight:700;font-size:1.05em;margin-bottom:6px}
.top-expense .amount{font-size:1.4em;font-weight:800;color:var(--expense);white-space:nowrap}
.top-expense .percent{font-size:0.85em;color:#7f8c8d;margin-top:4px}
.progress-bar{
  background:#ecf0f1;
  height:10px;
  border-radius:5px;
  overflow:hidden;
  margin-top:10px;
}
.progress-fill{
  background:var(--expense);
  height:100%;
  transition:width 0.5s ease;
}
.alert-badge{
  background:var(--danger);
  color:#fff;
  padding:5px 10px;
  border-radius:15px;
  font-size:0.75em;
  font-weight:700;
  margin-left:8px;
}
.btn{
  border:none;
  padding:16px 20px;
  border-radius:12px;
  cursor:pointer;
  font-size:16px;
  font-weight:700;
  width:100%;
  background:var(--success);
  color:#fff;
  margin-bottom:12px;
  transition:all 0.3s ease;
  box-shadow:0 4px 16px rgba(39,174,96,0.4);
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  min-height:48px;
  letter-spacing:0.3px;
}
.btn:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 24px rgba(39,174,96,0.5);
}
.btn:active{
  transform:translateY(1px);
  box-shadow:0 2px 10px rgba(39,174,96,0.4);
}
.btn-danger{background:var(--danger);padding:12px;font-size:0.95em;box-shadow:0 4px 12px rgba(231,76,60,0.3)}
.btn-edit{background:#3498db;padding:12px;font-size:0.95em;box-shadow:0 4px 12px rgba(52,152,219,0.3)}
.btn-warning{background:var(--warning);box-shadow:0 4px 12px rgba(243,156,18,0.3)}
.section{
  display:none;
  animation:slideIn 0.3s ease-out;
  padding-bottom:30px;
  overflow-x:hidden;
}
.section.active{display:block}
@keyframes slideIn{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}
.info-box{
  background:linear-gradient(135deg,#fff8f0,#ffe8d6);
  border-left:5px solid #a1a1aa;
  padding:14px;
  border-radius:12px;
  margin-bottom:15px;
  font-size:0.95em;
  box-shadow:0 2px 6px rgba(229,228,226,0.15);
  text-align:center;
}
body.dark .info-box{background:linear-gradient(135deg,#3d2817,#5c3d1f);color:#ffd699;border-left-color:#e5e4e2}
.filters{
  background:var(--card);
  padding:16px;
  border-radius:12px;
  margin-bottom:15px;
  box-shadow:0 2px 8px rgba(0,0,0,0.06);
}
.filter-row{display:flex;gap:10px;margin-bottom:10px}
.filter-row input,.filter-row select{
  flex:1;
  padding:12px;
  border:2px solid rgba(192,192,192,0.3);
  border-radius:12px;
  background:rgba(42,42,42,0.9);
  color:#ffffff;
  font-size:1em;
  transition:all 0.3s ease;
  font-weight:500;
}
.filter-row input:focus,.filter-row select:focus{
  border-color:rgba(255,170,0,0.7);
  outline:none;
  box-shadow:0 0 0 3px rgba(229,228,226,0.15);
  background:rgba(53,53,53,0.95);
}

/* FILTRI MODERNI */
.filter-section-modern{
  background:linear-gradient(135deg, rgba(102,126,234,0.06), rgba(118,75,162,0.06));
  padding:16px;
  border-radius:12px;
  margin-bottom:12px;
  border:2px solid rgba(102,126,234,0.12);
}
body.dark .filter-section-modern{
  background:linear-gradient(135deg, rgba(102,126,234,0.12), rgba(118,75,162,0.12));
  border-color:rgba(102,126,234,0.2);
}
.filter-label-modern{
  display:block;
  font-weight:700;
  font-size:0.9em;
  color:var(--text);
  margin-bottom:12px;
  opacity:0.9;
}
.filter-row-modern{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.select-modern{
  padding:12px 14px;
  border:2px solid var(--border);
  border-radius:10px;
  background:var(--card);
  color:var(--text);
  font-size:0.95em;
  font-weight:600;
  cursor:pointer;
  transition:all 0.3s;
  appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 14 14'%3E%3Cpath fill='%23667eea' d='M7 10L2 5h10z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;
  background-position:right 10px center;
  padding-right:35px;
}
.select-modern:focus{
  outline:none;
  border-color:#a1a1aa;
  box-shadow:0 0 0 3px rgba(102,126,234,0.15);
  transform:translateY(-1px);
}
.select-modern option{
  background:#2a2a2a;
  color:#ffffff;
  padding:10px;
}

/* Ottimizzazioni iPhone */
@media(max-width:400px){
  .filter-row-modern{
    gap:8px;
  }
  .select-modern{
    font-size:0.85em;
    padding:10px 12px;
    padding-right:30px;
  }
  .filter-label-modern{
    font-size:0.85em;
  }
  .checkbox-text-modern{
    font-size:0.85em;
  }
}
@media(max-width:380px){
  .select-modern{
    font-size:0.8em;
    padding:9px 10px;
    padding-right:28px;
  }
}

/* CHECKBOX MODERNO */
.checkbox-modern{
  position:relative;
}
.checkbox-input-modern{
  position:absolute;
  opacity:0;
  cursor:pointer;
}
.checkbox-label-modern{
  display:flex;
  align-items:center;
  cursor:pointer;
  user-select:none;
  -webkit-user-select:none;
}
.checkbox-box-modern{
  position:relative;
  width:22px;
  height:22px;
  border:2px solid var(--border);
  border-radius:6px;
  background:var(--card);
  margin-right:12px;
  transition:all 0.3s;
  flex-shrink:0;
}
.checkbox-box-modern::after{
  content:'‚úì';
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%) scale(0);
  color:#fff;
  font-weight:900;
  font-size:14px;
  transition:transform 0.2s ease;
}
.checkbox-input-modern:checked + .checkbox-label-modern .checkbox-box-modern{
  background:linear-gradient(135deg, #a1a1aa, #71717a);
  border-color:#a1a1aa;
}
.checkbox-input-modern:checked + .checkbox-label-modern .checkbox-box-modern::after{
  transform:translate(-50%, -50%) scale(1);
}
.checkbox-label-modern:hover .checkbox-box-modern{
  border-color:#a1a1aa;
  transform:scale(1.05);
}
.checkbox-text-modern{
  font-weight:600;
  font-size:0.95em;
  color:var(--text);
  line-height:1.4;
}
.checkbox-text-short{
  display:none;
}

/* Responsive filtri per iPhone */
@media(max-width:400px){
  .filter-row-modern{
    gap:8px;
  }
  .select-modern{
    font-size:0.85em;
    padding:10px 12px;
    padding-right:30px;
  }
  .filter-label-modern{
    font-size:0.85em;
  }
  .checkbox-text-modern{
    font-size:0.85em;
  }
  .checkbox-text-full{
    display:none;
  }
  .checkbox-text-short{
    display:inline;
  }
}
@media(max-width:380px){
  .select-modern{
    font-size:0.8em;
    padding:9px 10px;
    padding-right:28px;
  }
  .checkbox-box-modern{
    width:20px;
    height:20px;
  }
  .filter-section-modern{
    padding:14px;
  }
}

.trans-item{
  background:var(--card);
  padding:16px;
  border-radius:12px;
  margin-bottom:14px;
  border-left:5px solid var(--expense);
  box-shadow:0 2px 8px rgba(0,0,0,0.08);
  position:relative;
  transition:transform 0.3s cubic-bezier(0.4,0,0.2,1);
  touch-action:pan-y;
}
.trans-item.swiping{
  transform:translateX(var(--swipe-offset));
  transition:none;
}
.trans-item.swipe-delete{
  transform:translateX(-100%);
  opacity:0;
}
.trans-item::after{
  content:'üóëÔ∏è Elimina';
  position:absolute;
  right:0;
  top:0;
  bottom:0;
  background:linear-gradient(90deg,transparent,#e74c3c);
  color:#fff;
  display:flex;
  align-items:center;
  padding:0 20px;
  font-weight:700;
  opacity:0;
  transition:opacity 0.2s;
  pointer-events:none;
  z-index:-1;
  border-radius:0 12px 12px 0;
}
.trans-item.show-delete::after{
  opacity:1;
}
.trans-item.income{border-left-color:var(--income)}
.trans-header{display:flex;justify-content:space-between;margin-bottom:12px;align-items:center}
.trans-amount{font-size:1.4em;font-weight:800;white-space:nowrap}
.trans-details{font-size:0.9em;color:#7f8c8d;margin-bottom:12px;line-height:1.5}
.trans-actions{display:flex;gap:8px;position:relative;z-index:10}
.trans-actions button{
  flex:1;
  padding:12px;
  border-radius:10px;
  border:none;
  font-weight:700;
  cursor:pointer;
  font-size:0.95em;
  transition:all 0.3s;
  pointer-events:auto;
  touch-action:manipulation;
  -webkit-tap-highlight-color:rgba(0,0,0,0.1);
}
.trans-actions button:active{transform:scale(0.95)}
.analysis-card{
  background:var(--card);
  border-radius:12px;
  padding:16px;
  margin-bottom:14px;
  box-shadow:0 2px 8px rgba(0,0,0,0.06);
  border-left:5px solid var(--expense);
}
.analysis-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:14px;
}
.analysis-header h4{font-size:1.05em;font-weight:700}
.analysis-value{font-size:2em;font-weight:800;color:var(--expense);margin-bottom:8px}
.comparison{font-size:0.9em;color:#7f8c8d;margin-top:6px;line-height:1.4}
.cat-item{
  background:var(--card);
  padding:14px;
  border-radius:10px;
  margin-bottom:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow:0 2px 6px rgba(0,0,0,0.06);
}
.cat-item.income{background:#d5f4e6;border-left:5px solid var(--income)}
.cat-item.expense{background:#fadbd8;border-left:5px solid var(--danger)}
body.dark .cat-item.income{background:#1a4d2e}
body.dark .cat-item.expense{background:#5c2e2e}
.cat-actions{display:flex;gap:6px}
.nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:var(--nav-gradient);
  border-top:3px solid var(--border);
  display:flex;
  justify-content:center;
  padding:10px 16px max(env(safe-area-inset-bottom, 10px), 10px) 16px;
  z-index:100;
  box-shadow:0 -4px 20px rgba(0,0,0,0.4);
  overflow-x:auto;
  overflow-y:hidden;
  -webkit-overflow-scrolling:touch;
  scroll-behavior:smooth;
  gap:8px;
  scrollbar-width:none;
  transition:background 0.3s ease;
}
.nav::-webkit-scrollbar{height:0;display:none}
.nav-item{
  color:#ffffff;
  text-align:center;
  padding:10px 12px;
  cursor:pointer;
  transition:all 0.3s ease;
  border-radius:12px;
  font-size:0.75em;
  font-weight:700;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  min-width:70px;
  flex-shrink:0;
  white-space:nowrap;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  border:2px solid transparent;
}
.nav-item:hover{
  background:rgba(255,170,0,0.2);
  border-color:rgba(192,192,192,0.4);
}
.nav-item.active{
  background:rgba(192,192,192,0.3);
  color:#e5e4e2;
  transform:translateY(-3px);
  box-shadow:0 4px 20px rgba(192,192,192,0.4);
  border:2px solid rgba(255,170,0,0.6);
  text-shadow:0 0 10px rgba(192,192,192,0.4);
}
.nav-icon{font-size:2em;line-height:1;margin-bottom:4px}
.modal{
  display:none;
  position:fixed;
  top:0;
  left:0;
  right:0;
  bottom:0;
  background:rgba(0,0,0,0.95);
  z-index:1000;
  padding:15px;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  backdrop-filter:blur(8px);
}
.modal.active{display:flex;align-items:center;justify-content:center}
.modal-content{
  background:var(--card);
  border-radius:20px;
  padding:20px;
  width:100%;
  max-width:500px;
  max-height:90vh;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  box-shadow:0 10px 40px rgba(0,0,0,0.3);
  animation:modalSlideUp 0.3s ease-out;
}
@keyframes modalSlideUp{
  from{transform:translateY(30px);opacity:0}
  to{transform:translateY(0);opacity:1}
}
.modal-header{display:flex;justify-content:space-between;margin-bottom:20px;align-items:center}
.modal-header h3{font-size:1.3em;font-weight:700}

/* MODAL CONFERMA PERSONALIZZATO */
.confirm-modal{
  display:none;
  position:fixed;
  top:0;
  left:0;
  right:0;
  bottom:0;
  background:rgba(0,0,0,0.9);
  z-index:10000;
  padding:15px;
  overflow-y:auto;
  backdrop-filter:blur(8px);
  animation:fadeIn 0.2s ease-out;
}
.confirm-modal.active{display:flex;align-items:center;justify-content:center}
.confirm-content{
  background:var(--card);
  border-radius:20px;
  padding:30px 25px;
  width:100%;
  max-width:420px;
  box-shadow:0 20px 60px rgba(0,0,0,0.4);
  animation:confirmPop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  text-align:center;
}
@keyframes confirmPop{
  from{transform:scale(0.8);opacity:0}
  to{transform:scale(1);opacity:1}
}
@keyframes fadeIn{
  from{opacity:0}
  to{opacity:1}
}
.confirm-icon{
  font-size:4em;
  margin-bottom:15px;
  animation:iconBounce 0.6s ease-out;
}
@keyframes iconBounce{
  0%{transform:scale(0)}
  50%{transform:scale(1.2)}
  100%{transform:scale(1)}
}
.confirm-title{
  font-size:1.4em;
  font-weight:800;
  margin-bottom:12px;
  color:var(--text);
}
.confirm-message{
  font-size:1em;
  color:#7f8c8d;
  margin-bottom:25px;
  line-height:1.5;
}
.confirm-buttons{
  display:flex;
  gap:12px;
  margin-top:20px;
}
.confirm-btn{
  flex:1;
  padding:16px 20px;
  border:none;
  border-radius:12px;
  font-size:1em;
  font-weight:700;
  cursor:pointer;
  transition:all 0.2s;
  touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;
}
.confirm-btn-cancel{
  background:var(--bg);
  color:var(--text);
  border:2px solid var(--border);
}
.confirm-btn-cancel:active{transform:scale(0.95)}
.confirm-btn-confirm{
  background:var(--danger);
  color:#fff;
  box-shadow:0 4px 12px rgba(231,76,60,0.3);
}
.confirm-btn-confirm:active{transform:scale(0.95);box-shadow:0 2px 6px rgba(231,76,60,0.3)}
.confirm-btn-primary{
  background:var(--success);
  color:#fff;
  box-shadow:0 4px 12px rgba(39,174,96,0.3);
}
.confirm-btn-primary:active{transform:scale(0.95);box-shadow:0 2px 6px rgba(39,174,96,0.3)}

.close-btn{
  background:none;
  border:none;
  font-size:2em;
  cursor:pointer;
  color:#999;
  padding:0;
  width:40px;
  height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.form-group{margin-bottom:16px}
.form-group label{
  display:block;
  margin-bottom:8px;
  font-weight:700;
  font-size:0.95em;
  color:var(--text);
}
.form-group input,.form-group select,.form-group textarea{
  width:100%;
  padding:14px;
  border:2px solid var(--border);
  border-radius:10px;
  font-size:16px;
  background:#2a2a2a;
  color:var(--text);
  font-family:inherit;
  -webkit-appearance:none;
  appearance:none;
  touch-action:manipulation;
}
.form-group select{
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23e5e4e2' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;
  background-position:right 12px center;
  padding-right:40px;
  cursor:pointer;
}
.form-group select option{
  background:#2a2a2a;
  color:#ffffff;
  padding:12px;
}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{
  outline:none;
  border-color:#3498db;
}
.empty{
  text-align:center;
  padding:50px 20px;
  color:#95a5a6;
  font-size:1.1em;
}
canvas{max-width:100%;height:auto!important}
table{width:100%;border-collapse:collapse;font-size:0.75em}
th{
  background:#3498db;
  color:#fff;
  padding:10px 6px;
  text-align:center;
  font-weight:700;
  position:sticky;
  top:0;
  z-index:10;
}
th.expense{background:var(--expense)}
td{padding:10px 6px;text-align:center;border-bottom:1px solid var(--border)}
td:first-child{text-align:left;font-weight:600}
.table-wrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
.stats{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:12px;
  font-size:0.95em;
}
.stats div{
  background:var(--bg);
  padding:12px;
  border-radius:10px;
  text-align:center;
}
.stats .label{opacity:0.7;font-size:0.85em;margin-bottom:6px}
.stats .value{font-size:1.3em;font-weight:800}

/* CALENDAR HEATMAP COMPATTO - DESIGN CHIARO E FUNZIONALE */
.heatmap-compact {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  justify-content: center;
  padding: 10px 0;
  max-width: 100%;
}
.heatmap-compact-day {
  width: 38px;
  height: 38px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.8em;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  border: 2px solid transparent;
}

/* GIORNI SENZA SPESE - Grigio chiaro con bordo tratteggiato */
.heatmap-compact-day.no-expense {
  background: var(--bg);
  border: 2px dashed #ddd;
  color: #bbb;
  opacity: 0.6;
}
.heatmap-compact-day.no-expense:hover {
  opacity: 1;
  border-color: #999;
}

/* GIORNI CON SPESE - Scala da verde a rosso */
.heatmap-compact-day.has-expense {
  color: #fff;
  font-weight: 800;
  box-shadow: 0 2px 4px rgba(0,0,0,0.15);
}

/* Livelli di spesa - molto pi√π chiari */
.heatmap-compact-day.level-1 {
  background: linear-gradient(135deg, #52c41a, #73d13d);
  border-color: #389e0d;
}
.heatmap-compact-day.level-2 {
  background: linear-gradient(135deg, #fadb14, #ffc53d);
  border-color: #d4b106;
  color: #333;
}
.heatmap-compact-day.level-3 {
  background: linear-gradient(135deg, #fa8c16, #ff9c6e);
  border-color: #d46b08;
}
.heatmap-compact-day.level-4 {
  background: linear-gradient(135deg, #f5222d, #ff4d4f);
  border-color: #cf1322;
}
.heatmap-compact-day.level-5 {
  background: linear-gradient(135deg, #a8071a, #cf1322);
  border-color: #820014;
  box-shadow: 0 0 12px rgba(168,7,26,0.5);
}

/* Hover effect */
.heatmap-compact-day:hover {
  transform: scale(1.25);
  z-index: 10;
  box-shadow: 0 6px 16px rgba(0,0,0,0.3);
}

/* Oggi - bordo speciale */
.heatmap-compact-day.today {
  border: 3px solid #1890ff;
  box-shadow: 0 0 0 3px rgba(24,144,255,0.2);
}
.heatmap-compact-day.today.no-expense {
  background: #e6f7ff;
  border-color: #1890ff;
  color: #1890ff;
  opacity: 1;
}

/* Tooltip migliorato */
.heatmap-compact-day::after {
  content: attr(data-amount);
  position: absolute;
  bottom: -24px;
  left: 50%;
  transform: translateX(-50%) scale(0);
  background: rgba(0,0,0,0.9);
  color: #fff;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.7em;
  white-space: nowrap;
  pointer-events: none;
  transition: transform 0.2s;
  z-index: 100;
}
.heatmap-compact-day:hover::after {
  transform: translateX(-50%) scale(1);
}

/* Legenda migliorata */
.heatmap-compact-legend {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  margin-top: 15px;
  font-size: 0.75em;
  color: #7f8c8d;
  flex-wrap: wrap;
  padding: 10px;
  background: var(--bg);
  border-radius: 8px;
}
.heatmap-legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}
.heatmap-compact-legend-box {
  width: 20px;
  height: 20px;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

/* Stats grid */
.heatmap-stats {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 15px;
}
.heatmap-stat {
  text-align: center;
  padding: 12px 8px;
  background: var(--bg);
  border-radius: 10px;
  border: 1px solid var(--border);
}
.heatmap-stat-label {
  font-size: 0.7em;
  color: #7f8c8d;
  margin-bottom: 6px;
  font-weight: 600;
}
.heatmap-stat-value {
  font-size: 1.2em;
  font-weight: 800;
  color: var(--expense);
}

/* Dark mode */
body.dark .heatmap-compact-day.no-expense {
  background: var(--header);
  border-color: #444;
  color: #666;
}
body.dark .heatmap-compact-day.today.no-expense {
  background: #0a2540;
  border-color: #1890ff;
  color: #1890ff;
}

/* Responsive */
@media (max-width: 400px) {
  .heatmap-compact-day {
    width: 32px;
    height: 32px;
    font-size: 0.7em;
  }
  .heatmap-stats {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ========== LOADING STATES ========== */
.loading-overlay{
  position:fixed;
  top:0;left:0;right:0;bottom:0;
  background:rgba(0,0,0,0.7);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:10000;
  backdrop-filter:blur(4px);
}
.spinner{
  width:50px;
  height:50px;
  border:4px solid rgba(255,255,255,0.3);
  border-top-color:#fff;
  border-radius:50%;
  animation:spin 0.8s linear infinite;
}
@keyframes spin{
  to{transform:rotate(360deg)}
}
.skeleton{
  background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0 50%,#f0f0f0 75%);
  background-size:200% 100%;
  animation:skeleton-loading 1.5s ease-in-out infinite;
  border-radius:8px;
}
@keyframes skeleton-loading{
  0%{background-position:200% 0}
  100%{background-position:-200% 0}
}

/* ========== TOAST NOTIFICATIONS ========== */
.toast-container{
  position:fixed;
  top:80px;
  right:20px;
  z-index:9999;
  display:flex;
  flex-direction:column;
  gap:10px;
}
.toast{
  background:#fff;
  color:#2c3e50;
  padding:16px 20px;
  border-radius:12px;
  box-shadow:0 8px 24px rgba(0,0,0,0.2);
  display:flex;
  align-items:center;
  gap:12px;
  min-width:300px;
  max-width:400px;
  animation:slideInRight 0.3s ease-out,fadeOut 0.3s ease-in 2.7s forwards;
  transform-origin:right center;
}
.toast.success{border-left:4px solid #27ae60}
.toast.error{border-left:4px solid #e74c3c}
.toast.warning{border-left:4px solid #f39c12}
.toast.info{border-left:4px solid #3498db}
.toast-icon{font-size:1.5em}
.toast-message{flex:1;font-weight:600;font-size:0.95em}
@keyframes slideInRight{
  from{transform:translateX(400px);opacity:0}
  to{transform:translateX(0);opacity:1}
}
@keyframes fadeOut{
  to{opacity:0;transform:translateX(400px)}
}

/* ========== ANIMATIONS ========== */
@keyframes fadeIn{
  from{opacity:0}
  to{opacity:1}
}
@keyframes slideUp{
  from{transform:translateY(20px);opacity:0}
  to{transform:translateY(0);opacity:1}
}
@keyframes scaleIn{
  from{transform:scale(0.9);opacity:0}
  to{transform:scale(1);opacity:1}
}
@keyframes shake{
  0%,100%{transform:translateX(0)}
  10%,30%,50%,70%,90%{transform:translateX(-5px)}
  20%,40%,60%,80%{transform:translateX(5px)}
}
@keyframes pulse{
  0%,100%{transform:scale(1)}
  50%{transform:scale(1.05)}
}
@keyframes checkmark{
  0%{stroke-dashoffset:100}
  100%{stroke-dashoffset:0}
}

/* Button animations */
.btn{
  transition:all 0.2s cubic-bezier(0.4,0,0.2,1);
  position:relative;
  overflow:hidden;
}
.btn:active{
  transform:scale(0.96);
}
.btn::after{
  content:'';
  position:absolute;
  top:50%;left:50%;
  width:0;height:0;
  border-radius:50%;
  background:rgba(255,255,255,0.3);
  transform:translate(-50%,-50%);
  transition:width 0.6s,height 0.6s;
}
.btn:active::after{
  width:300px;
  height:300px;
}

/* Smooth scroll */
html{
  scroll-behavior:smooth;
}

/* Card animations */
.card{
  animation:fadeIn 0.3s ease-out;
}

/* Success checkmark */
.success-checkmark{
  width:80px;
  height:80px;
  margin:20px auto;
}
.success-checkmark .check-icon{
  width:80px;
  height:80px;
  position:relative;
  border-radius:50%;
  box-sizing:content-box;
  border:4px solid #27ae60;
}
.success-checkmark .check-icon::before{
  top:3px;
  left:-2px;
  width:30px;
  transform-origin:100% 50%;
  border-radius:100px 0 0 100px;
}
.success-checkmark .check-icon::after{
  top:0;
  left:30px;
  width:60px;
  transform-origin:0 50%;
  border-radius:0 100px 100px 0;
  animation:rotate-circle 4.25s ease-in;
}
.success-checkmark .check-icon::before,
.success-checkmark .check-icon::after{
  content:'';
  height:100px;
  position:absolute;
  background:#fff;
  transform:rotate(-45deg);
}
.success-checkmark .icon-line{
  height:5px;
  background-color:#27ae60;
  display:block;
  border-radius:2px;
  position:absolute;
  z-index:10;
}
.success-checkmark .icon-line.line-tip{
  top:46px;
  left:14px;
  width:25px;
  transform:rotate(45deg);
  animation:icon-line-tip 0.75s;
}
.success-checkmark .icon-line.line-long{
  top:38px;
  right:8px;
  width:47px;
  transform:rotate(-45deg);
  animation:icon-line-long 0.75s;
}
@keyframes icon-line-tip{
  0%{width:0;left:1px;top:19px}
  54%{width:0;left:1px;top:19px}
  70%{width:50px;left:-8px;top:37px}
  84%{width:17px;left:21px;top:48px}
  100%{width:25px;left:14px;top:46px}
}
@keyframes icon-line-long{
  0%{width:0;right:46px;top:54px}
  65%{width:0;right:46px;top:54px}
  84%{width:55px;right:0;top:35px}
  100%{width:47px;right:8px;top:38px}
}

/* Empty states */
.empty-state{
  text-align:center;
  padding:60px 20px;
  color:var(--text);
  opacity:0.7;
}
.empty-state-icon{
  font-size:4em;
  margin-bottom:20px;
  opacity:0.5;
}
.empty-state-title{
  font-size:1.3em;
  font-weight:700;
  margin-bottom:10px;
}
.empty-state-description{
  font-size:0.95em;
  opacity:0.8;
}

.chart-container{
  position:relative;
  height:280px;
  margin:15px 0;
}
.spending-summary{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
  margin-bottom:15px;
}
@media(max-width:600px){
  .spending-summary{
    gap:8px;
  }
}
.summary-box{
  background:linear-gradient(135deg,var(--expense),#d35400);
  color:#fff;
  padding:16px;
  border-radius:12px;
  text-align:center;
  box-shadow:0 4px 12px rgba(230,126,34,0.3);
}
@media(max-width:600px){
  .summary-box{
    padding:12px;
  }
}
.summary-box.income-box{
  background:linear-gradient(135deg,var(--income),#1e8449);
  box-shadow:0 4px 12px rgba(39,174,96,0.3);
}
.summary-label{font-size:0.85em;opacity:0.9;margin-bottom:8px;font-weight:600}
@media(max-width:600px){
  .summary-label{font-size:0.8em;margin-bottom:6px}
}
.summary-value{font-size:1.8em;font-weight:800;margin-bottom:4px}
@media(max-width:600px){
  .summary-value{font-size:1.5em}
}
.summary-detail{font-size:0.8em;opacity:0.85}
@media(max-width:600px){
  .summary-detail{font-size:0.75em}
}
.monthly-detail{
  background:var(--card);
  padding:14px;
  border-radius:10px;
  margin-bottom:10px;
  border-left:4px solid #3498db;
}
.monthly-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}
.monthly-name{font-weight:700;font-size:1em}
.monthly-amount{font-size:1.3em;font-weight:800;color:#3498db}
.monthly-bar{
  background:#ecf0f1;
  height:8px;
  border-radius:4px;
  overflow:hidden;
}
.monthly-fill{
  background:#3498db;
  height:100%;
  transition:width 0.5s ease;
}
.toast{
  position:fixed;
  top:80px;
  left:50%;
  transform:translateX(-50%);
  background:#27ae60;
  color:#fff;
  padding:14px 24px;
  border-radius:12px;
  z-index:10000;
  font-weight:700;
  box-shadow:0 4px 16px rgba(0,0,0,0.3);
  animation:toastIn 0.3s ease-out;
}
@keyframes toastIn{from{opacity:0;transform:translate(-50%,-20px)}to{opacity:1;transform:translateX(-50%)}}
@media(max-width:380px){
  .big{font-size:2.4em}
  .metric .val{font-size:1.4em}
  .nav-item{font-size:0.7em}
}

/* WIDGET RIASSUNTIVO */
.widget-float{
  position:fixed;
  bottom:95px;
  right:max(env(safe-area-inset-right),15px);
  background:linear-gradient(135deg,#a1a1aa,#71717a);
  color:#fff;
  padding:12px 16px;
  border-radius:20px;
  box-shadow:0 4px 20px rgba(0,0,0,0.3);
  z-index:99;
  cursor:pointer;
  transition:all 0.3s;
  font-weight:700;
  font-size:0.85em;
  min-width:120px;
}
.widget-float:active{transform:scale(0.95)}
.widget-label{font-size:0.75em;opacity:0.9;margin-bottom:4px}
.widget-value{font-size:1.4em;font-weight:800}

/* CALENDARIO - Lista Mobile Friendly */
.calendar-day-item{
  background:var(--card);
  border-radius:12px;
  padding:15px;
  margin-bottom:10px;
  border-left:4px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
  cursor:pointer;
  transition:all 0.3s;
  box-shadow:0 2px 6px rgba(0,0,0,0.05);
}
.calendar-day-item:active{transform:scale(0.98)}
.calendar-day-item.today{
  border-left-color:#3498db;
  background:linear-gradient(135deg,rgba(52,152,219,0.1),rgba(52,152,219,0.05));
  font-weight:700;
}
.calendar-day-item.has-expense{border-left-color:#e74c3c}
.calendar-day-item.has-income{border-left-color:#27ae60}
.calendar-day-item.has-both{border-left-color:#f39c12}
.calendar-day-left{flex:1}
.calendar-day-date{
  font-size:1.1em;
  font-weight:700;
  margin-bottom:4px;
}
.calendar-day-weekday{
  font-size:0.85em;
  opacity:0.7;
}
.calendar-day-right{
  text-align:right;
}
.calendar-day-amount{
  font-size:1.1em;
  font-weight:700;
  margin-bottom:4px;
}
.calendar-day-count{
  font-size:0.8em;
  opacity:0.7;
}
.calendar-empty{
  text-align:center;
  padding:40px 20px;
  opacity:0.6;
  font-size:0.95em;
}

/* RICERCA AVANZATA - DESIGN COMPLETAMENTE RINNOVATO */
.advanced-search{
  background:linear-gradient(135deg, #a1a1aa 0%, #71717a 100%);
  padding:24px;
  border-radius:20px;
  margin-bottom:20px;
  box-shadow:0 8px 24px rgba(102,126,234,0.35);
  border:none;
  animation:slideDown 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  position:relative;
  overflow:hidden;
}
.advanced-search::before{
  content:'';
  position:absolute;
  top:-50%;
  right:-50%;
  width:200%;
  height:200%;
  background:radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
  animation:pulse 3s ease-in-out infinite;
}
@keyframes pulse{
  0%, 100%{transform:scale(1);opacity:0.5}
  50%{transform:scale(1.1);opacity:0.8}
}
body.dark .advanced-search{
  background:linear-gradient(135deg, #4a5f9f 0%, #5a3d73 100%);
  box-shadow:0 8px 24px rgba(74,95,159,0.4);
}
@keyframes slideDown{
  from{opacity:0;transform:translateY(-20px) scale(0.95);max-height:0}
  to{opacity:1;transform:translateY(0) scale(1);max-height:800px}
}
.advanced-search h4{
  color:#fff;
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:20px;
  font-size:1.2em;
  text-shadow:0 2px 4px rgba(0,0,0,0.2);
  position:relative;
  z-index:1;
}
.search-section{
  background:rgba(255,255,255,0.95);
  border-radius:16px;
  padding:18px;
  margin-bottom:16px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  position:relative;
  z-index:1;
}
body.dark .search-section{
  background:rgba(30,30,50,0.95);
}
.search-section-title{
  font-size:0.9em;
  font-weight:700;
  color:#a1a1aa;
  margin-bottom:12px;
  display:flex;
  align-items:center;
  gap:6px;
}
body.dark .search-section-title{
  color:#9fb4ff;
}
.search-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.search-grid input{
  padding:14px 12px;
  border:2px solid #e0e0e0;
  border-radius:12px;
  background:#fff;
  color:var(--text);
  font-size:0.95em;
  font-weight:600;
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 2px 4px rgba(0,0,0,0.05);
}
body.dark .search-grid input{
  background:#1a1a2e;
  border-color:#2d4059;
  color:#eee;
}
.search-grid input:focus{
  outline:none;
  border-color:#a1a1aa;
  box-shadow:0 0 0 4px rgba(102,126,234,0.2), 0 4px 12px rgba(102,126,234,0.15);
  transform:translateY(-2px);
}
.search-grid input::placeholder{
  color:#999;
  font-weight:500;
}
/* Label e select per ordinamento */
.search-section label{
  color:var(--text);
  font-weight:700;
  font-size:0.9em;
  display:block;
  margin-bottom:8px;
}
.search-section select{
  width:100%;
  padding:14px 12px;
  border:2px solid #e0e0e0;
  border-radius:12px;
  background:#fff;
  color:var(--text);
  font-size:0.95em;
  font-weight:600;
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 2px 4px rgba(0,0,0,0.05);
  cursor:pointer;
  appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%23667eea' d='M8 11L3 6h10z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;
  background-position:right 12px center;
  padding-right:40px;
}
body.dark .search-section select{
  background-color:#1a1a2e;
  border-color:#2d4059;
  color:#eee;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%239fb4ff' d='M8 11L3 6h10z'/%3E%3C/svg%3E");
}
.search-section select:focus{
  outline:none;
  border-color:#a1a1aa;
  box-shadow:0 0 0 4px rgba(102,126,234,0.2), 0 4px 12px rgba(102,126,234,0.15);
  transform:translateY(-1px);
}
.advanced-search button{
  margin-top:0;
  padding:14px;
  font-size:1em;
  font-weight:700;
  transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  background:#fff;
  color:#e74c3c;
  border:none;
  border-radius:12px;
  box-shadow:0 4px 12px rgba(231,76,60,0.2);
  cursor:pointer;
  position:relative;
  z-index:1;
  width:100%;
}
.advanced-search button:hover{
  transform:translateY(-3px);
  box-shadow:0 8px 20px rgba(231,76,60,0.35);
  background:#fff;
}
.advanced-search button:active{
  transform:translateY(-1px);
}

/* TABELLE RIEPILOGO MENSILE - VERSIONE COMPATTA */
.table-container-compact{
  background:var(--card);
  border-radius:12px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 2px 8px rgba(0,0,0,0.06);
  overflow:hidden;
}
.collapsible-header{
  user-select:none;
  -webkit-user-select:none;
}
.collapsible-header:hover{
  transform:translateY(-3px);
  box-shadow:0 8px 24px rgba(102,126,234,0.4) !important;
}
.collapsible-header:active{
  transform:translateY(-1px);
  box-shadow:0 4px 16px rgba(102,126,234,0.3) !important;
}
#tabelleContent{
  animation:slideDownTable 0.4s ease-out;
  overflow:hidden;
}
@keyframes slideDownTable{
  from{opacity:0;max-height:0}
  to{opacity:1;max-height:3000px}
}
.table-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:15px;
  padding-bottom:12px;
  border-bottom:2px solid var(--border);
}
.table-title{
  font-size:1.1em;
  font-weight:800;
  display:flex;
  align-items:center;
  gap:8px;
}
.table-title.income{color:var(--income)}
.table-title.expense{color:var(--expense)}
.table-title.savings{color:#a1a1aa}
.year-selector{
  display:flex;
  gap:8px;
  align-items:center;
}
.year-btn{
  background:var(--bg);
  border:2px solid var(--border);
  color:var(--text);
  padding:8px 16px;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
  font-size:0.9em;
  transition:all 0.2s;
}
.year-btn:hover{
  background:var(--income);
  color:#fff;
  border-color:var(--income);
  transform:scale(1.05);
}
.year-display{
  font-size:1.1em;
  font-weight:700;
  min-width:60px;
  text-align:center;
}
.monthly-table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  overflow:hidden;
  border-radius:12px;
}
.monthly-table thead{
  background:linear-gradient(135deg, #a1a1aa, #71717a);
  color:#fff;
}
.monthly-table thead th{
  padding:10px 10px;
  font-weight:700;
  font-size:0.9em;
  text-align:left;
  border:none;
}
.monthly-table thead th:first-child{
  border-radius:12px 0 0 0;
}
.monthly-table thead th:last-child{
  border-radius:0 12px 0 0;
  text-align:right;
}
.monthly-table tbody tr{
  transition:all 0.2s;
  background:var(--card);
}
.monthly-table tbody tr:hover{
  background:var(--bg);
  transform:scale(1.01);
}
.monthly-table tbody tr.current-month{
  background:linear-gradient(90deg, rgba(102,126,234,0.15), rgba(102,126,234,0.05));
  font-weight:700;
}
.monthly-table tbody tr.current-month td{
  border-top:2px solid #a1a1aa;
  border-bottom:2px solid #a1a1aa;
}
.monthly-table tbody tr.current-month td:first-child{
  border-left:2px solid #a1a1aa;
}
.monthly-table tbody tr.current-month td:last-child{
  border-right:2px solid #a1a1aa;
}
.monthly-table tbody td{
  padding:8px 10px;
  border-bottom:1px solid var(--border);
  font-size:0.9em;
}
.monthly-table tbody td:last-child{
  text-align:right;
  font-weight:700;
  font-size:0.95em;
}
.monthly-table tbody tr:last-child td{
  border-bottom:none;
}
.monthly-table tbody tr:last-child td:first-child{
  border-radius:0 0 0 12px;
}
.monthly-table tbody tr:last-child td:last-child{
  border-radius:0 0 12px 0;
}
.month-name{
  font-weight:600;
  display:flex;
  align-items:center;
  gap:8px;
}
.month-icon{
  font-size:1.2em;
}
.amount-positive{
  color:var(--income);
}
.amount-negative{
  color:var(--expense);
}
.amount-neutral{
  color:#a1a1aa;
}
.table-footer{
  margin-top:15px;
  padding-top:15px;
  border-top:3px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:1.1em;
}
.table-footer-label{
  font-weight:700;
  color:var(--text);
}
.table-footer-value{
  font-size:1.3em;
  font-weight:800;
}
.table-footer-value.income{color:var(--income)}
.table-footer-value.expense{color:var(--expense)}
.table-footer-value.savings{color:#a1a1aa}

/* Responsive per tabelle */
@media(max-width:600px){
  .monthly-table{font-size:0.85em}
  .monthly-table thead th{padding:10px 8px}
  .monthly-table tbody td{padding:10px 8px}
  .table-title{font-size:1em}
  .year-btn{padding:6px 10px;font-size:0.8em}
  .year-display{font-size:1em;min-width:50px}
  .table-header{flex-wrap:wrap;gap:10px}
  .savings-container{padding:18px}
  .savings-title{font-size:1.3em}
  .savings-subtitle{font-size:0.85em}
  .savings-grid{gap:10px}
  .savings-bucket{padding:15px}
  .savings-bucket-icon{font-size:2em}
  .savings-bucket-label{font-size:0.85em}
  .savings-bucket-percent{font-size:0.9em}
  .savings-bucket-amount{font-size:1.1em}
}

/* PREVISIONI */
.prediction-card{
  background:linear-gradient(135deg,#a1a1aa,#71717a);
  color:#fff;
  padding:20px;
  border-radius:12px;
  margin-bottom:15px;
}
.prediction-value{
  font-size:1.8em;
  font-weight:800;
  margin:10px 0;
  word-break:break-word;
  line-height:1.2;
}
@media (min-width:768px) {
  .prediction-value{font-size:2.2em}
}
.prediction-detail{
  font-size:0.85em;
  opacity:0.9;
  line-height:1.4;
  word-break:break-word;
}

/* ========== EVOLUZIONE PATRIMONIO SEMPLICE ========== */
.evo-period-btn {
  background: rgba(255,215,0,0.1);
  border: 2px solid rgba(255,215,0,0.3);
  color: #e5e4e2;
  padding: 8px 20px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 700;
  font-size: 0.9em;
  transition: all 0.3s;
}

.evo-period-btn:hover {
  background: rgba(255,215,0,0.2);
  border-color: rgba(255,215,0,0.5);
}

.evo-period-btn.active {
  background: linear-gradient(135deg, #e5e4e2, #ffa500);
  border-color: #e5e4e2;
  color: #1a1a2e;
  box-shadow: 0 4px 12px rgba(255,215,0,0.4);
}
.evolution-glass-card {
  background: rgba(26, 26, 46, 0.7);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 1.5px solid rgba(255, 215, 0, 0.25);
  border-radius: 20px;
  padding: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.1);
  position: relative;
  overflow: visible;
  margin-bottom: 20px;
  z-index: 10; /* Base z-index per la card */
}

.evolution-glass-card::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,215,0,0.08) 0%, transparent 70%);
  animation: evoGlow 6s ease-in-out infinite;
  pointer-events: none;
  z-index: 0;
}

@keyframes evoGlow {
  0%, 100% { transform: translate(0, 0) scale(1); }
  50% { transform: translate(-20px, -20px) scale(1.05); }
}

.evo-glass-header {
  position: relative;
  z-index: 1;
  text-align: center;
  margin-bottom: 20px;
}

.evo-glass-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 14px;
  background: rgba(255, 215, 0, 0.12);
  border: 1px solid rgba(255, 215, 0, 0.25);
  border-radius: 20px;
  font-size: 0.75em;
  font-weight: 700;
  color: #e5e4e2;
  text-transform: uppercase;
  letter-spacing: 1.2px;
  margin-bottom: 12px;
  backdrop-filter: blur(10px);
}

.evo-glass-amount {
  font-size: 2.8em;
  font-weight: 900;
  background: linear-gradient(135deg, #fff 0%, #e5e4e2 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  line-height: 1;
  margin-bottom: 10px;
  filter: drop-shadow(0 0 20px rgba(255,215,0,0.3));
}

.evo-glass-delta {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 0.95em;
  font-weight: 700;
  padding: 6px 12px;
  background: rgba(78,204,163,0.12);
  border: 1px solid rgba(78,204,163,0.3);
  border-radius: 16px;
  color: #4ecca3;
  backdrop-filter: blur(5px);
}

.evo-glass-delta.negative {
  background: rgba(242,54,69,0.12);
  border-color: rgba(242,54,69,0.3);
  color: #f23645;
}

/* Controls Container - 2 Righe */
.evo-controls-container {
  position: relative;
  z-index: 100;
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 20px;
}

/* Riga 1: Data Selectors */
.evo-date-row {
  display: flex;
  justify-content: center; /* Centra */
}

/* Riga 2: Pills */
.evo-pills-row {
  display: flex;
  justify-content: center; /* Centra */
}

/* Dual Selector Container */
.evo-dual-selector {
  position: relative;
  display: flex;
  gap: 6px;
  max-width: 100%;
}

/* Anno Selector */
.evo-year-selector {
  position: relative; /* Per dropdown */
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 14px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 215, 0, 0.2);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
  backdrop-filter: blur(10px);
  flex: 0 0 auto;
  min-width: 95px;
}

.evo-year-selector:active {
  transform: scale(0.96);
}

.evo-year-icon {
  font-size: 1em;
}

.evo-year-text {
  font-size: 0.9em;
  font-weight: 700;
  color: #e5e4e2;
  white-space: nowrap;
}

.evo-year-arrow {
  font-size: 0.7em;
  color: rgba(255, 215, 0, 0.6);
  transition: transform 0.3s;
}

.evo-year-selector.active .evo-year-arrow {
  transform: rotate(180deg);
}

/* Mese Mini Selector */
.evo-month-mini-selector {
  position: relative; /* Per dropdown */
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 14px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 215, 0, 0.2);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
  backdrop-filter: blur(10px);
  flex: 0 0 auto;
  min-width: 115px;
}

.evo-month-mini-selector:active {
  transform: scale(0.96);
}

.evo-month-mini-text {
  font-size: 0.9em;
  font-weight: 700;
  color: #e5e4e2;
  white-space: nowrap;
}

.evo-month-mini-arrow {
  font-size: 0.7em;
  color: rgba(255, 215, 0, 0.6);
  transition: transform 0.3s;
  flex-shrink: 0;
}

.evo-month-mini-selector.active .evo-month-mini-arrow {
  transform: rotate(180deg);
}

/* Dropdown Anno */
.evo-year-dropdown {
  position: absolute;
  top: calc(100% + 6px);
  left: 0;
  width: 100px;
  background: rgba(26, 26, 46, 0.98);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 215, 0, 0.25);
  border-radius: 10px;
  padding: 6px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
  display: none;
  z-index: 10000;
}

.evo-year-dropdown.active {
  display: block;
  animation: evoSlideDown 0.2s ease-out;
}

/* Dropdown Mese */
.evo-month-mini-dropdown {
  position: absolute;
  top: calc(100% + 6px);
  right: 0;
  width: 130px;
  background: rgba(26, 26, 46, 0.98);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 215, 0, 0.25);
  border-radius: 10px;
  padding: 6px;
  max-height: 280px;
  overflow-y: auto;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
  display: none;
  z-index: 10000;
}

.evo-month-mini-dropdown.active {
  display: block;
  animation: evoSlideDown 0.2s ease-out;
}

/* Opzioni Dropdown */
.evo-dropdown-option {
  padding: 8px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.85em;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.8);
  transition: all 0.2s;
  text-align: center;
}

.evo-dropdown-option:hover {
  background: rgba(255, 215, 0, 0.1);
  color: #e5e4e2;
}

.evo-dropdown-option.selected {
  background: rgba(255, 215, 0, 0.2);
  color: #e5e4e2;
}

.evo-month-selector:hover {
  background: rgba(255, 255, 255, 0.08);
  border-color: rgba(255, 215, 0, 0.35);
}

.evo-month-selector:active {
  transform: scale(0.98);
}

.evo-month-icon {
  font-size: 1.1em;
}

.evo-month-text {
  flex: 1;
  font-size: 0.85em; /* Ridotto da 0.9em */
  font-weight: 700;
  color: #e5e4e2;
  white-space: nowrap; /* Previeni wrap */
  overflow: hidden; /* Nascondi overflow */
  text-overflow: ellipsis; /* Mostra ... */
  min-width: 0; /* Permetti shrinking */
}

.evo-month-arrow {
  font-size: 0.9em;
  color: rgba(255, 215, 0, 0.6);
  transition: transform 0.3s;
}

.evo-month-selector.active .evo-month-arrow {
  transform: rotate(180deg);
}

.evo-period-pills {
  display: flex;
  gap: 8px;
  padding: 4px;
  background: rgba(255, 255, 255, 0.04);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  justify-content: center;
}

.evo-pill {
  padding: 10px 20px; /* Aumentato per essere pi√π touch-friendly */
  background: transparent;
  border: none;
  border-radius: 8px;
  font-size: 0.85em;
  font-weight: 700;
  color: rgba(255, 255, 255, 0.5);
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  white-space: nowrap;
  min-width: 50px;
  text-align: center;
}

.evo-pill.active {
  background: rgba(255,215,0,0.2);
  color: #e5e4e2;
  box-shadow: 0 2px 8px rgba(255,215,0,0.3);
}

.evo-pill:active {
  transform: scale(0.95);
}

.evo-pill.active {
  background: rgba(255,215,0,0.2);
  color: #e5e4e2;
  box-shadow: 0 2px 10px rgba(255,215,0,0.25);
}

.evo-month-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  left: 0;
  width: 100%; /* Usa tutta la larghezza del selector */
  min-width: 180px; /* Minimo per leggibilit√† */
  max-width: 250px; /* Limite massimo */
  background: rgba(26, 26, 46, 0.98);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 215, 0, 0.25);
  border-radius: 12px;
  padding: 8px;
  max-height: 280px; /* Aumentato per mostrare pi√π mesi */
  overflow-y: auto;
  overflow-x: hidden;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
  display: none;
  z-index: 9999;
  pointer-events: none;
  
  /* Scroll personalizzato */
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 215, 0, 0.3) transparent;
}

.evo-month-dropdown::-webkit-scrollbar {
  width: 6px;
}

.evo-month-dropdown::-webkit-scrollbar-track {
  background: transparent;
}

.evo-month-dropdown::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0.3);
  border-radius: 3px;
}

.evo-month-dropdown::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 215, 0, 0.5);
}

.evo-month-dropdown.active {
  display: block;
  animation: evoSlideDown 0.3s ease-out;
  pointer-events: auto;
}

/* Assicura che niente possa coprire il dropdown */
.evolution-glass-card {
  position: relative;
  z-index: 10; /* Base z-index */
}

.evo-controls-row {
  position: relative;
  z-index: 100; /* Pi√π alto della card */
}

@keyframes evoSlideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

.evo-month-option {
  padding: 10px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.9em;
  font-weight: 600;
  color: rgba(255, 255, 255, 0.8);
  transition: all 0.2s;
}

.evo-month-option:hover {
  background: rgba(255, 215, 0, 0.1);
  color: #e5e4e2;
}

.evo-month-option.selected {
  background: rgba(255, 215, 0, 0.2);
  color: #e5e4e2;
}

.evo-chart-container {
  position: relative;
  z-index: 1;
  margin-bottom: 16px;
}

.evo-scroll-hint {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.7em;
  color: rgba(255, 215, 0, 0.6);
  margin-bottom: 8px;
  font-weight: 600;
}

.evo-scroll-hint-icon {
  animation: evoSlideHint 2s ease-in-out infinite;
}

@keyframes evoSlideHint {
  0%, 100% { transform: translateX(0); }
  50% { transform: translateX(4px); }
}

.evo-glass-chart {
  height: 200px;
  background: rgba(255, 255, 255, 0.02);
  border: 1px solid rgba(255, 215, 0, 0.1);
  border-radius: 14px;
  backdrop-filter: blur(5px);
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

.evo-glass-chart::-webkit-scrollbar {
  height: 4px;
}

.evo-glass-chart::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.02);
  border-radius: 2px;
}

.evo-glass-chart::-webkit-scrollbar-thumb {
  background: rgba(255, 215, 0, 0.3);
  border-radius: 2px;
}

.evo-glass-chart::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 215, 0, 0.5);
}

.evo-chart-inner {
  min-width: 800px;
  height: 100%;
  padding: 15px;
  position: relative;
}

.evo-chart-curve {
  position: absolute;
  bottom: 15px;
  left: 0;
  height: 130px;
  width: 100%;
  pointer-events: none; /* Non interferisce con hover lollipop */
}

.evo-curve-path {
  fill: none;
  stroke: url(#evoGradient);
  stroke-width: 2.5;
  stroke-linecap: round;
  filter: drop-shadow(0 0 6px rgba(255,215,0,0.5));
  animation: evoDrawPath 2s ease-out forwards;
}

.evo-curve-fill {
  fill: url(#evoGradientFill);
  opacity: 0.25;
  animation: evoFadeIn 2s ease-out forwards;
}

@keyframes evoDrawPath {
  from { stroke-dasharray: 1000; stroke-dashoffset: 1000; }
  to { stroke-dasharray: 1000; stroke-dashoffset: 0; }
}

@keyframes evoFadeIn {
  from { opacity: 0; }
  to { opacity: 0.25; }
}

.evo-chart-values {
  position: absolute;
  bottom: 15px;
  left: 15px;
  right: 15px;
  height: 130px;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  pointer-events: none;
  padding: 0 20px;
}

/* ORIGINAL SMOOTH CURVE STYLES */
.evo-value-marker {
  display: flex;
  flex-direction: column;
  align-items: center;
  animation: evoPopIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
  opacity: 0;
  margin: 0 4px;
  position: relative;
  height: 200px; /* Altezza fissa per contenere tutto */
  justify-content: flex-end; /* Labels in basso */
}

@keyframes evoPopIn {
  from { opacity: 0; transform: translateY(10px) scale(0.8); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* VALUE BOX sempre visibile */
.evo-value-box {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(26, 26, 46, 0.95);
  backdrop-filter: blur(10px);
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid rgba(255, 215, 0, 0.3);
  white-space: nowrap;
  z-index: 10;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 60px;
}

/* DOT posizionato dinamicamente */
.evo-value-dot {
  width: 14px;
  height: 14px;
  background: linear-gradient(135deg, #e5e4e2 0%, #ffed4e 50%, #ffa500 100%);
  border-radius: 50%;
  border: 3px solid rgba(26, 26, 46, 0.9);
  box-shadow: 
    0 0 0 2px rgba(255, 215, 0, 0.3),
    0 4px 12px rgba(255, 215, 0, 0.5),
    0 0 20px rgba(255, 215, 0, 0.3);
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  z-index: 2;
  transition: all 0.3s;
}

.evo-box-amount {
  font-size: 0.85em;
  font-weight: 800;
  color: #e5e4e2;
  text-align: center;
  line-height: 1.2;
}

.evo-box-percent {
  font-size: 0.7em;
  font-weight: 700;
  text-align: center;
  padding: 2px 6px;
  border-radius: 4px;
  margin-bottom: 3px;
}

.evo-box-percent.positive {
  color: #00ff88;
  background: rgba(0, 255, 136, 0.15);
}

.evo-box-percent.negative {
  color: #ff4757;
  background: rgba(255, 71, 87, 0.15);
}

.evo-box-percent.neutral {
  color: rgba(255, 255, 255, 0.4);
}

.evo-value-line {
  display: none !important; /* Nascosto - dots sono sulla linea */
}

.evo-value-tooltip {
  display: none !important; /* Nascosto - usa value box invece */
}

.evo-value-dot {
  width: 14px;
  height: 14px;
  background: linear-gradient(135deg, #e5e4e2 0%, #ffed4e 50%, #ffa500 100%);
  border-radius: 50%;
  border: 3px solid rgba(26, 26, 46, 0.9);
  box-shadow: 
    0 0 0 2px rgba(255, 215, 0, 0.3),
    0 4px 12px rgba(255, 215, 0, 0.5),
    0 0 20px rgba(255, 215, 0, 0.3);
  position: relative; /* Relative dentro il container */
  z-index: 2;
  transition: all 0.3s;
}

.evo-value-dot:hover {
  transform: translateX(-50%) scale(1.3);
  box-shadow: 
    0 0 0 3px rgba(255, 215, 0, 0.5),
    0 6px 20px rgba(255, 215, 0, 0.7),
    0 0 30px rgba(255, 215, 0, 0.5);
}

.evo-value-dot.current {
  background: linear-gradient(135deg, #00ff88 0%, #00dd77 50%, #00bb66 100%);
  animation: evoDotPulse 2s ease-in-out infinite;
  box-shadow: 
    0 0 0 2px rgba(0, 255, 136, 0.4),
    0 4px 12px rgba(0, 255, 136, 0.6),
    0 0 20px rgba(0, 255, 136, 0.4);
}

@keyframes evoDotPulse {
  0%, 100% { 
    transform: translateX(-50%) scale(1);
    box-shadow: 0 0 0 2px rgba(0, 255, 136, 0.4),
                0 4px 12px rgba(0, 255, 136, 0.6),
                0 0 20px rgba(0, 255, 136, 0.4);
  }
  50% { 
    transform: translateX(-50%) scale(1.2);
    box-shadow: 0 0 0 4px rgba(0, 255, 136, 0.6),
                0 6px 20px rgba(0, 255, 136, 0.8),
                0 0 35px rgba(0, 255, 136, 0.6);
  }
}

.evo-value-tooltip {
  position: absolute;
  bottom: calc(100% + 12px);
  left: 50%;
  transform: translateX(-50%);
  background: rgba(26, 26, 46, 0.95);
  backdrop-filter: blur(10px);
  padding: 8px 12px;
  border-radius: 10px;
  border: 1px solid rgba(255, 215, 0, 0.3);
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s, transform 0.3s;
  z-index: 10;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.evo-value-marker:hover .evo-value-tooltip {
  opacity: 1;
  transform: translateX(-50%) translateY(-5px);
}

.evo-value-amount {
  font-size: 0.95em;
  font-weight: 800;
  color: #e5e4e2;
  text-align: center;
  line-height: 1.3;
  margin-bottom: 3px;
}

.evo-value-percent {
  font-size: 0.75em;
  font-weight: 700;
  text-align: center;
  padding: 2px 6px;
  border-radius: 4px;
  line-height: 1.2;
}

.evo-value-percent.positive {
  color: #00ff88;
  background: rgba(0, 255, 136, 0.15);
}

.evo-value-percent.negative {
  color: #ff4757;
  background: rgba(255, 71, 87, 0.15);
}

.evo-month-label {
  font-size: 0.7em;
  font-weight: 700;
  color: rgba(255, 215, 0, 0.8);
  margin-top: 8px;
  text-align: center;
  white-space: nowrap;
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}

.evo-value-marker:hover .evo-month-label {
  color: #e5e4e2;
}

/* Hide lollipop styles */
.evo-lollipop-marker,
.evo-yellow-box {
  display: none !important;
}

/* === OVERRIDES FOR DOTS ON LINE === */
.evo-value-marker {
  position: absolute !important;
  margin: 0 4px !important; /* Pi√π vicini */
}

.evo-value-line {
  display: none !important; /* Non serve pi√π */
}

/* BOX VALORE SEMPRE VISIBILE */
.evo-value-box {
  position: absolute;
  bottom: 24px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(26, 26, 46, 0.95);
  backdrop-filter: blur(10px);
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid rgba(255, 215, 0, 0.3);
  white-space: nowrap;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  min-width: 65px;
  text-align: center;
}

.evo-box-amount {
  font-size: 0.85em;
  font-weight: 800;
  color: #e5e4e2;
  line-height: 1.2;
  margin-bottom: 2px;
}

.evo-box-percent {
  font-size: 0.7em;
  font-weight: 700;
  padding: 2px 4px;
  border-radius: 4px;
  line-height: 1.1;
}

.evo-box-percent.positive {
  color: #00ff88;
  background: rgba(0, 255, 136, 0.15);
}

.evo-box-percent.negative {
  color: #ff4757;
  background: rgba(255, 71, 87, 0.15);
}

.evo-box-percent.neutral {
  color: rgba(255, 255, 255, 0.4);
}

.evo-month-label {
  position: absolute !important;
  top: 24px !important; /* Sotto il dot */
  left: 50% !important;
  transform: translateX(-50%) !important;
  margin-top: 0 !important;
}

.evo-value-tooltip {
  display: none !important; /* Nascosto, usiamo box */
}

.evo-value-tooltip {
  background: rgba(255, 215, 0, 0.95);
  color: #16213e;
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 0.75em;
  font-weight: 800;
  margin-bottom: 10px;
  white-space: nowrap;
  box-shadow: 0 3px 12px rgba(255,215,0,0.5);
  backdrop-filter: blur(10px);
  min-width: 60px;
  text-align: center;
}

.evo-value-amount {
  font-size: 1.05em;
  line-height: 1.2;
  margin-bottom: 2px;
}

.evo-value-percent {
  font-size: 0.85em;
  opacity: 0.9;
}

.evo-value-percent.positive {
  color: #27ae60;
}

.evo-value-percent.negative {
  color: #e74c3c;
}

.evo-value-dot {
  width: 10px;
  height: 10px;
  background: #e5e4e2;
  border: 3px solid #16213e;
  border-radius: 50%;
  box-shadow: 0 0 15px rgba(255,215,0,0.9);
}

.evo-value-line {
  width: 2px;
  background: linear-gradient(180deg, rgba(255,215,0,0.5), transparent);
}

.evo-glass-stats {
  position: relative;
  z-index: 1;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.evo-stat-glass {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 215, 0, 0.15);
  border-radius: 12px;
  padding: 12px;
  text-align: center;
  backdrop-filter: blur(10px);
  transition: all 0.3s;
}

.evo-stat-glass:active {
  transform: scale(0.97);
}

.evo-stat-icon {
  font-size: 1.1em;
  margin-bottom: 4px;
}

.evo-stat-name {
  font-size: 0.7em;
  color: rgba(255, 255, 255, 0.6);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  margin-bottom: 6px;
  font-weight: 600;
}

.evo-stat-number {
  font-size: 1.15em;
  font-weight: 800;
  color: #4ecca3;
}

.evo-stat-number.negative {
  color: #f23645;
}


/* REPORT MODAL */
.report-preview{
  background:#fff;
  padding:20px;
  border-radius:10px;
  margin:15px 0;
}
.report-header{
  text-align:center;
  padding-bottom:15px;
  border-bottom:2px solid #3498db;
  margin-bottom:15px;
}
.report-section{
  margin-bottom:15px;
  padding:10px;
  background:#f8f9fa;
  border-radius:8px;
}

/* Calendario iPhone fix */
#calendario .card{
  margin-bottom:30px;
  padding-bottom:30px;
}
#calendario{
  padding-bottom:40px;
}

/* Media query per schermi piccoli */
@media (max-width: 400px) {
  .card{
    padding:15px;
  }
  .calendar-day-item{
    padding:12px;
  }
  .calendar-day-date{
    font-size:1em;
  }
  .calendar-day-amount{
    font-size:1em;
  }
}


/* SPESE CONDIVISE */
.trans-item.condiviso {
  border-left-color: #e74c3c !important;
  background: linear-gradient(90deg, rgba(231,76,60,0.08) 0%, var(--card) 15%);
  position: relative;
}
.trans-item.condiviso::after {
  content: '';
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 0em;
  opacity: 0;
}
.condiviso-badge {
  display: inline-block;
  background: #e74c3c;
  color: #fff;
  padding: 3px 10px;
  border-radius: 10px;
  font-size: 0.75em;
  font-weight: 700;
  margin-left: 8px;
  vertical-align: middle;
}
.condiviso-badge::before {
  content: 'üíë ';
  margin-right: 3px;
}

/* OTTIMIZZAZIONI MOBILE - SAFE AREA */
@supports (padding: max(0px)) {
  body {
    padding-left: max(env(safe-area-inset-left), 0px);
    padding-right: max(env(safe-area-inset-right), 0px);
  }
  
  .header {
    padding-left: max(env(safe-area-inset-left), 15px);
    padding-right: max(env(safe-area-inset-right), 15px);
  }
  
  .content {
    padding-left: max(env(safe-area-inset-left), 15px);
    padding-right: max(env(safe-area-inset-right), 15px);
  }
  
  .nav {
    padding-left: max(env(safe-area-inset-left), 8px);
    padding-right: max(env(safe-area-inset-right), 8px);
  }
}

/* CORREZIONE OVERFLOW BARRA NAVIGAZIONE */
.nav {
  width: 100%;
  max-width: 100vw;
  box-sizing: border-box;
}

.nav-item {
  flex-shrink: 0;
  min-width: 70px;
}

/* ASSICURA CHE TUTTO SIA CONTENUTO */
* {
  max-width: 100%;
  box-sizing: border-box;
}

html, body {
  overflow-x: hidden;
  width: 100%;
  position: relative;
}

/* ENTRATE CONDIVISE (quando lei paga) */
.trans-item.income.condiviso {
  border-left-color: #27ae60 !important;
  background: linear-gradient(90deg, rgba(39,174,96,0.08) 0%, var(--card) 15%);
}

/* TRANSAZIONI "SPESA DI LEI" */
.trans-item.partner {
  border-left-color: #9b59b6 !important;
  background: linear-gradient(90deg, rgba(155,89,182,0.08) 0%, var(--card) 15%);
}
.trans-item.partner .trans-amount {
  color: #9b59b6 !important;
}

/* TRANSAZIONI "SPESA DI LEI" */
.trans-item.partner_payment {
  border-left-color: #9b59b6 !important;
  background: linear-gradient(90deg, rgba(155,89,182,0.08) 0%, var(--card) 15%);
}

/* SISTEMA RISPARMIO 15/25/65 */
.savings-container{
  background:linear-gradient(135deg,#a1a1aa 0%,#71717a 100%);
  color:#fff;
  border-radius:16px;
  padding:20px;
  margin-bottom:15px;
  box-shadow:0 4px 12px rgba(102,126,234,0.3);
}
.savings-title{
  font-size:1.4em;
  font-weight:800;
  margin-bottom:8px;
  text-align:center;
}
.savings-subtitle{
  text-align:center;
  opacity:0.9;
  font-size:0.9em;
  margin-bottom:20px;
}
.savings-grid{
  display:grid;
  grid-template-columns:1fr;
  gap:12px;
  margin-bottom:20px;
}
.savings-bucket{
  background:rgba(255,255,255,0.15);
  backdrop-filter:blur(10px);
  border-radius:12px;
  padding:15px 10px;
  text-align:center;
  transition:all 0.3s;
}
.savings-bucket:active{
  transform:scale(0.95);
}
.savings-bucket-icon{
  font-size:2em;
  margin-bottom:8px;
}
.savings-bucket-label{
  font-size:0.75em;
  opacity:0.9;
  margin-bottom:4px;
  font-weight:600;
}
.savings-bucket-percent{
  font-size:1.8em;
  font-weight:800;
  margin-bottom:4px;
}
.savings-bucket-amount{
  font-size:1.1em;
  font-weight:700;
  opacity:0.95;
}
.savings-total{
  background:rgba(255,255,255,0.2);
  backdrop-filter:blur(10px);
  border-radius:12px;
  padding:15px;
  text-align:center;
  margin-bottom:15px;
}
.savings-total-label{
  font-size:0.85em;
  opacity:0.9;
  margin-bottom:4px;
}
.savings-total-value{
  font-size:2em;
  font-weight:800;
}
.savings-progress{
  background:rgba(255,255,255,0.2);
  border-radius:12px;
  padding:12px;
  margin-bottom:15px;
}
.savings-progress-label{
  font-size:0.85em;
  opacity:0.9;
  margin-bottom:8px;
  display:flex;
  justify-content:space-between;
}
.savings-progress-bar{
  background:rgba(255,255,255,0.3);
  height:12px;
  border-radius:6px;
  overflow:hidden;
}
.savings-progress-fill{
  background:linear-gradient(90deg,#27ae60,#2ecc71);
  height:100%;
  transition:width 0.5s ease;
  border-radius:6px;
}
.savings-actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.savings-btn{
  background:rgba(255,255,255,0.25);
  border:2px solid rgba(255,255,255,0.4);
  color:#fff;
  padding:12px;
  border-radius:10px;
  font-weight:700;
  font-size:0.9em;
  cursor:pointer;
  transition:all 0.3s;
}
.savings-btn:active{
  transform:scale(0.95);
  background:rgba(255,255,255,0.35);
}

/* Responsive grid for Tendenza Risparmio Mensile */
@media(max-width:600px){
  #savingsTrendCustom{
    grid-template-columns:repeat(2,1fr) !important;
  }
}
@media(max-width:400px){
  #savingsTrendCustom{
    grid-template-columns:1fr !important;
  }
}

/* ========== MOBILE RESPONSIVE DARK PATRIMONIO ========== */
@media(max-width:768px){
  /* FIX: Performance numeri mobile - previeni overflow */
  #perfEntrate, #perfUscite, #perfRisparmiato {
    font-size: 1.2em !important;
    word-break: break-word;
  }
  
  /* Performance grid mobile - pi√π compatto */
  div[style*="grid-template-columns:repeat(3,1fr)"] {
    gap: 10px !important;
  }
  
  div[style*="grid-template-columns:repeat(3,1fr)"] > div {
    padding: 0 5px;
  }
  
  /* CRITICAL: Force no horizontal overflow */
  #finanze, #finanze * {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* Patrimonio card container */
  .card[style*="linear-gradient(135deg, #1a1a2e"] {
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding: 0 !important;
    overflow: hidden !important;
    width: 100% !important;
  }
  
  /* Header patrimonio */
  .card[style*="linear-gradient(135deg, #1a1a2e"] > div:first-child {
    padding: 20px 10px !important;
  }
  
  /* Selettore mese container */
  div[style*="display:flex"][style*="justify-content:center"][style*="gap:15px"] {
    gap: 8px !important;
    flex-wrap: wrap !important;
    padding: 0 !important;
  }
  
  /* Selettore centrale - RIDIMENSIONA */
  div[onclick="toggleSelectoreMesi()"] {
    min-width: 140px !important;
    max-width: 140px !important;
    padding: 10px 15px !important;
    font-size: 0.85em !important;
  }
  
  div[onclick="toggleSelectoreMesi()"] > div:first-child {
    font-size: 0.65em !important;
    letter-spacing: 0.5px !important;
  }
  
  div[onclick="toggleSelectoreMesi()"] > div:nth-child(2) {
    font-size: 0.95em !important;
  }
  
  /* Selettore mesi compatto su mobile */
  .card[style*="linear-gradient(135deg, #1a1a2e"] {
    margin-left: -15px;
    margin-right: -15px;
    border-radius: 0 !important;
  }
  
  /* Controlli mese pi√π grandi su mobile */
  button[onclick*="cambiaPatrimonioStorico"] {
    min-width: 45px !important;
    min-height: 45px !important;
    font-size: 1.3em !important;
  }
  
  /* Dropdown selector pi√π grande */
  div[onclick="toggleSelectoreMesi()"] {
    min-width: 160px !important;
    padding: 14px 20px !important;
  }
  
  /* Patrimonio totale pi√π leggibile */
  #patrimonioTotaleVista {
    font-size: 2.5em !important;
    line-height: 1.1 !important;
  }
  
  /* Variazione pi√π compatta */
  #patrimonioVariazione {
    font-size: 1em !important;
    padding: 6px 12px !important;
  }
  
  /* Tabs pi√π grandi e touch-friendly */
  button[id^="tab"] {
    padding: 14px 10px !important;
    font-size: 0.8em !important;
    min-height: 48px !important;
  }
  
  /* Grid conti 2 colonne su mobile */
  #tabContentOverview > div:first-child {
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 10px !important;
  }
  
  /* Card conti pi√π compatte */
  #tabContentOverview > div:first-child > div {
    padding: 12px 10px !important;
  }
  
  #tabContentOverview > div:first-child > div > div:first-child {
    font-size: 0.7em !important;
  }
  
  #tabContentOverview > div:first-child > div > div:last-child {
    font-size: 1.1em !important;
  }
  
  /* Performance mese mobile */
  #tabContentOverview > div:nth-child(2) {
    padding: 15px 12px !important;
  }
  
  #tabContentOverview > div:nth-child(2) > div:nth-child(2) {
    gap: 10px !important;
  }
  
  #tabContentOverview > div:nth-child(2) > div:nth-child(2) > div > div:first-child {
    font-size: 0.7em !important;
  }
  
  #tabContentOverview > div:nth-child(2) > div:nth-child(2) > div > div:last-child {
    font-size: 1.2em !important;
  }
  
  /* FIX OVERFLOW FINANZE MOBILE */
  .card[style*="linear-gradient(135deg, #1a1a2e"] {
    overflow: visible !important;
  }
  
  /* Contenitore tabs overflow */
  #tabContentOverview,
  #tabContentGrafico,
  #tabContentConfronto {
    overflow-x: hidden !important;
    max-width: 100% !important;
  }
  
  /* Fix saldo mese floating - pi√π alto per non toccare navbar */
  div[style*="Saldo Mese"] {
    position: fixed !important;
    right: 15px !important;
    bottom: 105px !important;
    z-index: 50 !important;
  }
  
  /* Previeni horizontal scroll */
  body, .content {
    overflow-x: hidden !important;
    max-width: 100vw !important;
  }
  
  /* ========== FIX CATEGORIE TESTO LUNGO ========== */
  /* Truncate category names on mobile */
  .cat-item,
  [style*="background:linear"][style*="border-radius:12px"] > div:first-child,
  [onclick*="editCategoria"] {
    max-width: 100% !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
  }
  
  /* Category cards container */
  [style*="display:grid"][style*="gap:12px"] {
    grid-template-columns: 1fr !important;
    gap: 10px !important;
  }
  
  /* Category card layout fix */
  .cat-card {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 14px 10px !important;
  }
  
  /* Category name - allow wrapping but limit */
  .cat-name {
    flex: 1 !important;
    min-width: 0 !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
    font-size: 0.95em !important;
    font-weight: 700 !important;
  }
  
  /* Category action buttons */
  .cat-actions {
    display: flex !important;
    gap: 6px !important;
    flex-shrink: 0 !important;
  }
  
  .cat-actions button {
    min-width: 40px !important;
    padding: 8px !important;
    font-size: 1.1em !important;
  }
  
  /* CRITICAL: Limit all buttons in category rows */
  div[style*="border-left:4px"] button,
  div[style*="padding:14px"] button {
    max-width: 42px !important;
    min-width: 42px !important;
    padding: 10px 8px !important;
    font-size: 1em !important;
  }
  
  /* Specific fix for ‚Üí Necessit√† button */
  button[onclick*="cambiaClassificazione"] {
    min-width: 95px !important;
    max-width: 95px !important;
    padding: 8px 6px !important;
    font-size: 0.75em !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: clip !important;
    flex-shrink: 0 !important;
  }
  
  /* Category name in row - truncate long text */
  div[style*="border-left:4px"] > div:first-child {
    flex: 1 !important;
    min-width: 0 !important;
    max-width: calc(100% - 220px) !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
    padding-right: 8px !important;
  }
  



  /* Pulsanti periodo grafico touch-friendly */
  button[id^="evo"] {
    padding: 12px 10px !important;
    font-size: 0.8em !important;
    min-width: 70px !important;
    min-height: 44px !important;
  }
  
  /* Canvas grafici mobile */
  #patrimonioChart, #risparmiChart {
    max-height: 220px !important;
  }
  
  /* Radio confronto pi√π grandi */
  input[type="radio"][name="confronto"] {
    width: 22px !important;
    height: 22px !important;
  }
  
  label[onclick*="selezionaConfronto"] {
    padding: 16px 14px !important;
    min-height: 52px !important;
  }
  
  label[onclick*="selezionaConfronto"] span {
    font-size: 0.9em !important;
  }
  
  /* Dropdown mesi mobile */
  #dropdownMesi {
    max-height: 280px !important;
    margin-left: -10px !important;
    margin-right: -10px !important;
  }
  
  #listaDropdownMesi > div {
    padding: 14px 12px !important;
  }
  
  #listaDropdownMesi > div > div:first-child {
    font-size: 0.9em !important;
  }
  
  #listaDropdownMesi > div > div:last-child {
    font-size: 0.85em !important;
  }
}

@media(max-width:480px){
  /* Extra small mobile */
  #patrimonioTotaleVista {
    font-size: 2.2em !important;
  }
  
  button[id^="tab"] {
    font-size: 0.75em !important;
    padding: 12px 8px !important;
  }
  
  /* Grid conti singola colonna per schermi molto piccoli */
  #tabContentOverview > div:first-child {
    grid-template-columns: 1fr !important;
  }
}

/* ========== ANIMAZIONI LOGIN ========== */
@keyframes fadeIn {
  from { opacity:0; transform:translateY(-20px); }
  to { opacity:1; transform:translateY(0); }
}
@keyframes bounce {
  0%, 100% { transform:translateY(0); }
  50% { transform:translateY(-10px); }
}
@keyframes fadeOut {
  to { opacity:0; transform:scale(0.9); }
}
@keyframes shake {
  0%, 100% { transform:translateX(0); }
  25% { transform:translateX(-10px); }
  75% { transform:translateX(10px); }
}

/* SLIDER PATRIMONIO */
#patrimonioSlider {
  -webkit-appearance:none;
  appearance:none;
  width:100%;
  height:8px;
  border-radius:4px;
  background:linear-gradient(90deg,#667eea,#ffd700);
  outline:none;
  cursor:pointer;
}
#patrimonioSlider::-webkit-slider-thumb {
  -webkit-appearance:none;
  appearance:none;
  width:24px;
  height:24px;
  border-radius:50%;
  background:linear-gradient(135deg,#ffd700,#ff8c00);
  cursor:pointer;
  box-shadow:0 2px 8px rgba(255,215,0,0.5);
  border:3px solid #fff;
  transition:transform 0.2s;
}
#patrimonioSlider::-webkit-slider-thumb:hover {
  transform:scale(1.2);
}
#patrimonioSlider::-moz-range-thumb {
  width:24px;
  height:24px;
  border-radius:50%;
  background:linear-gradient(135deg,#ffd700,#ff8c00);
  cursor:pointer;
  box-shadow:0 2px 8px rgba(255,215,0,0.5);
  border:3px solid #fff;
}
